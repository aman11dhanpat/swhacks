<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Movie Theater WebVR Virtual Reality Experience Dying Light</title>
    <meta name="author" content="Donovan Kraeker">
    <meta name="description" content="A Movie Theater WebVR virtual reality example website experience using A-Frame designed by Donovan Kraeker">
    <!--<script src="/aframe-master/dist/aframe-master.js"></script>
    <script src="https://rawgit.com/mayognaise/aframe-html-shader/master/dist/aframe-html-shader.min.js"></script>-->
    <script src="http://mayognaise.github.io/aframe-html-shader/build.js"></script>

    <style type="text/css">
    #target {
      width: 512px;
      height: 256px;
      position: absolute;
      background: rgba(255,255,0,0.3);
    }
    #htmlTarget.hide {
      z-index: -1;
    }
    #target h1 {
      font-family: Arial;
      font-size: 110px;
      margin: 0;
      vertical-align: top;
      color: white;
    }
    #target h1 span {
      color: tomato;
    }
    #emoji {
      position: absolute;
      font-size: 512px;
      color: mediumTurquoise;
      font-style: serif;
    }
    #pre {
      font-family: monospace;
      margin: 0;
      padding: 0;
      height: 50px;
      font-size: 50px;
      background: royalblue;
      color: tomato;
    }
    #htmlTarget {
      position: absolute;
      z-index: 1;
      height: 100%;
      width: 100%;
      overflow: hidden;
    }
    #debug {
      position: absolute;
      bottom: 0;
      left: 0;
    }
    @media (max-width: 512px) {
      #target {
        width: 256px;
        height: 126px;
      }
      #target h1 {
        font-size: 55px;
      }
      #pre {
        height: 50px;
        font-size: 25px;
      }
      #emoji {
        position: absolute;
        font-size: 256px;
        color: mediumTurquoise;
      }
    }
    body[data-vr="true"] .novr{
      display: none;
    }
    </style>
  </head>
  <body>
    <a-scene>
     <a-entity camera position="0 1.7 7.5" look-controls="enabled: true" cursor-visible="enabled: false" wasd-controls="enabled: true"></a-entity>

     <!-- Ground highlight -->

        <!-- Ceiling Floor -->
        <a-entity geometry=" primitive: plane; height: 24; width: 22" position="0 0.5 2" rotation="-90 0 0" material="shader: flat; roughness: 1; src: url(images/floor.jpg)"></a-entity>
        <a-entity geometry=" primitive: box; depth: 0.1; height:24; width: 22" position="0 12.5 2" rotation="-90 0 0"  material="shader: standard; side: bottom; src: url(images/stars.jpg)"></a-entity>

        <!-- Front Back Walls -->
        <a-entity geometry=" primitive: box; depth: 0.1; height: 12; width: 22" position="0 6.5 -10" material="shader: standard; color: #000"></a-entity>
        <a-entity geometry=" primitive: box; depth: 0.1; height: 12; width: 22" position="0 6.5 14" material="shader: standard; color: #000"></a-entity>

        <!-- Side Walls -->
        <a-entity geometry=" primitive: box; depth: 0.1; height: 12; width: 24" position="11 6.5 2" rotation="0 90 0" material="shader: standard; roughness: 1; src: url(images/wall.jpg)"></a-entity>
        <a-entity geometry=" primitive: box; depth: 0.1; height: 12; width: 24" position="-11 6.5 2" rotation="0 90 0" material="shader: standard; roughness: 1; src: url(images/wall.jpg)"></a-entity>

        <!-- Molding -->
        <a-entity geometry=" primitive: box; depth: 0.5; height: 0.5; width: 24" position="-10.75 0.5 2" rotation="0 90 0" material="shader: standard; metalness: 0.5; color: #000"></a-entity>
        <a-entity geometry=" primitive: box; depth: 0.5; height: 0.5; width: 24" position="10.75 0.5 2" rotation="0 90 0" material="shader: standard; metalness: 0.5; color: #000"></a-entity>
        <a-entity geometry=" primitive: box; depth: 0.5; height: 0.5; width: 24" position="-10.75 12.5 2" rotation="0 90 0" material="shader: standard; metalness: 0.5; color: #000"></a-entity>
        <a-entity geometry=" primitive: box; depth: 0.5; height: 0.5; width: 24" position="10.75 12.5 2" rotation="0 90 0" material="shader: standard; metalness: 0.5; color: #000"></a-entity>

        <!-- Pillars Left -->
        <a-entity geometry=" primitive: box; depth: 0.5; height: 12; width: 1" position="-10.8 6.5 -5" rotation="0 90 0" material="shader: standard; metalness: 0.5; color: #000"></a-entity>
        <a-entity geometry=" primitive: box; depth: 0.5; height: 12; width: 1" position="-10.8 6.5 0" rotation="0 90 0" material="shader: standard; metalness: 0.5; color: #000"></a-entity>
        <a-entity geometry=" primitive: box; depth: 0.5; height: 12; width: 1" position="-10.8 6.5 5" rotation="0 90 0" material="shader: standard; metalness: 0.5; color: #000"></a-entity>
        <a-entity geometry=" primitive: box; depth: 0.5; height: 12; width: 1" position="-10.8 6.5 10" rotation="0 90 0" material="shader: standard; metalness: 0.5; color: #000"></a-entity>

        <!-- Pillars Right -->
        <a-entity geometry=" primitive: box; depth: 0.5; height: 12; width: 1" position="10.8 6.5 -5" rotation="0 90 0" material="shader: standard; metalness: 0.5; color: #000"></a-entity>
        <a-entity geometry=" primitive: box; depth: 0.5; height: 12; width: 1" position="10.8 6.5 0" rotation="0 90 0" material="shader: standard; metalness: 0.5; color: #000"></a-entity>
        <a-entity geometry=" primitive: box; depth: 0.5; height: 12; width: 1" position="10.8 6.5 5" rotation="0 90 0" material="shader: standard; metalness: 0.5; color: #000"></a-entity>
        <a-entity geometry=" primitive: box; depth: 0.5; height: 12; width: 1" position="10.8 6.5 10" rotation="0 90 0" material="shader: standard; metalness: 0.5; color: #000"></a-entity>

        <!-- Sconces -->
        <a-entity geometry=" primitive: cylinder; radius: 0.2; height: 0.5" position="10.7 9.5 -2.5" open-ended="false" material="shader: standard; metalness: 0.5; color: #26030d"></a-entity>
        <a-entity geometry=" primitive: cylinder; radius: 0.2; height: 0.5" position="10.7 9.5 2.5" open-ended="false" material="shader: standard; metalness:0.5; color: #26030d"></a-entity>
        <a-entity geometry=" primitive: cylinder; radius: 0.2; height: 0.5" position="10.7 9.5 7.5" open-ended="false" material="shader: standard; metalness:0.5; color: #26030d"></a-entity>
        <a-entity geometry=" primitive: cylinder; radius: 0.2; height: 0.5" position="-10.7 9.5 -2.5" open-ended="false" material="shader: standard; metalness:0.5; color: #26030d"></a-entity>
        <a-entity geometry=" primitive: cylinder; radius: 0.2; height: 0.5" position="-10.7 9.5 2.5" open-ended="false" material="shader: standard; metalness:0.5; color: #26030d"></a-entity>
        <a-entity geometry=" primitive: cylinder; radius: 0.2; height: 0.5" position="-10.7 9.5 7.5" open-ended="false" material="shader: standard; metalness:0.5; color: #26030d"></a-entity>

        <!-- Speakers -->
        <a-entity geometry=" primitive: box; depth: 0.5; height: 1; width: 0.7" position="10.5 9.5 -7.5" rotation="-10 90 0" material="shader: standard; roughness: 0.7; color: #000"></a-entity>
        <a-entity geometry=" primitive: box; depth: 0.5; height: 1; width: 0.7" position="-10.5 9.5 -7.5" rotation="10 90 0" material="shader: standard; roughness: 0.7; color: #000"></a-entity>
        <a-entity geometry=" primitive: box; depth: 0.5; height: 1; width: 0.7" position="10.5 9.5 12" rotation="-10 90 0" material="shader: standard; roughness: 0.7; color: #000"></a-entity>
        <a-entity geometry=" primitive: box; depth: 0.5; height: 1; width: 0.7" position="-10.5 9.5 12" rotation="10 90 0" material="shader: standard; roughness: 0.7; color: #000"></a-entity>

        <!-- Other -->
        <a-entity geometry=" primitive: plane; height: 2; width: 1" position="5 1.5 13.93" material="shader: flat; side: back; transparent: true; src: url(images/door.png)"></a-entity>
        <a-entity geometry=" primitive: plane; height: 0.5; width: 0.6" position="5 3.5 13.93" material="shader: flat; side: back; transparent: true; src: url(images/exit-sign.png)"></a-entity>
        <a-entity geometry=" primitive: box; depth: 2; height: 16; width: 18" position="0 2.8 -9.1" material="shader: standard; color: #000"></a-entity>

        <!--<a-video src="cv.mp4" autoplay="true" width="19" height="11" position="0 5.5 -8"></a-video>-->


      <!-- Lighting and background -->
      <a-sky color="#ccc"></a-sky>
      <a-entity id="lettersEntity" geometry="primitive:plane; height: 11; width: 19" position="0 5.5 -8"
            material="shader:html;target:#target;transparent:true;ratio:width;fps:1.5;"></a-entity>
    </a-scene>
    <div id="htmlTarget" class="hide">
      <div id="target">
        <h1><a href="google.com">HELLO</a><span>â˜…</span></h1>
        <span id="pre">A</span>
      </div>
    </div>


    <script>
    var pres = 'A-frame is fun!!!';

    var lettersEntity = document.getElementById('lettersEntity')
    var pre = document.getElementById('pre')
    var htmlTarget = document.getElementById('htmlTarget')
    var scene = document.querySelector('a-scene')
    if (scene.hasLoaded) { ready() }
    else { scene.addEventListener('loaded', ready) }

    function ready () {
      scene.addEventListener('enter-vr', function () { document.body.setAttribute('data-vr', true) })
      scene.addEventListener('exit-vr', function () { document.body.setAttribute('data-vr', false) })
      var fps2 = lettersEntity.getAttribute('material').fps
      console.log(fps2)
      //updateLetters(0, 1000/fps2)
      /////////////////////////////
      var iframe = document.createElement('iframe');
      iframe.src = "https://www.google.com";
      //pre.appendChild(iframe);
      document.getElementById('target').innerHTML = "";
      document.getElementById('target').appendChild(iframe);
    }
    function updateLetters (cnt, fps) {
      var indexEnd = ++cnt % (pres.length+1)
      if (pres.charAt(indexEnd) === ' ') {
        indexEnd = ++cnt % (pres.length+1)
      }
      pre.innerHTML = pres.substring(0, indexEnd)
      setTimeout(updateLetters, fps, cnt, fps)
      console.log ("Updated...")
    }
    function toggleVisibility () {
      htmlTarget.classList.toggle('hide');
    }
    function toggleLettersDebug () {
      var material = Object.assign({}, lettersEntity.getAttribute('material'))
      material.debug = !material.debug? '#debug' : ''
      lettersEntity.setAttribute('material', material)
    }
    </script>
  </body>
</html>
